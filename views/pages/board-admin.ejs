<!DOCTYPE html>
<html lang="en">

<head>
    <% include ../partials/head %>
        <script>
            var load = null;
            var del = null;

            $(document).ready(function() {
                //작성된 메모 목록을 로드합니다.
                var load = function() {
                    $.get('/load', function(data) {
                        $("#user_board").empty();

                        user_index = 1;

                        $(data).each(function(i) {
                            var id = this._id;

                            $("#user_board").prepend("<div class='item'></div>");

                            $("#user_board .item:first").append("<hr/><div class='contents " + id + "'>" + user_index + "</div>");
                            $("#user_board .item:first").append("<div class='user_name'><b>" + this.user_name + " | " + this.user_email + "</b> &nbsp;&nbsp;&nbsp;(" + this.date +
                                ") | <span class='text_button del'>DELETE</span></div>");
                            $("#user_board .item:first").append("<div class='contents " + id + "'>" + this.user_position + " | " + this.user_interest + "</div>");
                            $("#user_board .item:first").append("<div class='contents " + id + "'>" + this.user_description + "</div>");

                            //삭제 버튼을 눌렀을 때에 대한 이벤트 콜백함수를 지정합니다.
                            $("#user_board .item:first .del").click(function(evt) {
                                del(id);
                            });

                            user_index = user_index + 1;
                        });
                    });
                };

                //메모 삭제 요청을 처리하는 부분입니다.
                var del = function(id) {
                    var postdata = {
                        '_id': id
                    };

                    $.post('/del', postdata, function() {
                        load();
                    });
                };

                load();
            });
        </script>
</head>

<body>
    <div id='user_board'>
        <div class='item'>
        </div>
    </div>
    <% include ../partials/body_script %>
</body>

</html>
